<!DOCTYPE html>
<html lang="en">

<head>
	<title>Zimba Send us a message</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- <meta http-equiv="Content-Security-Policy"
		content="script-src https://*.zimbasolutions.io/ https://zimbasolutions.io;">
	<meta http-equiv="Content-Security-Policy"
		content="child-src 'self'  https://*.google.com https://www.zimbasolutions.io;"> -->
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css"
		href="https://static.zimbasolutions.io/vendor/bootstrap/css/bootstrap.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css"
		href="https://static.zimbasolutions.io/fonts/font-awesome-4.7.0/css/font-awesome.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="https://static.zimbasolutions.io/vendor/animate/animate.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css"
		href="https://static.zimbasolutions.io/vendor/css-hamburgers/hamburgers.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css"
		href="https://static.zimbasolutions.io/vendor/animsition/css/animsition.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="https://static.zimbasolutions.io/vendor/select2/select2.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css"
		href="https://static.zimbasolutions.io/vendor/daterangepicker/daterangepicker.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="https://static.zimbasolutions.io/css/util.css">
	<link rel="stylesheet" type="text/css" href="https://static.zimbasolutions.io/css/main.css">
	<!--===============================================================================================-->
</head>

<body>



	<div class="container-contact100">

		<div class="wrap-contact100">
			<form class="contact100-form validate-form" method="post" id="send-us-a-message-form"
				name="send-us-a-message-form"
				action="https://pwvfr31pn4.execute-api.us-east-1.amazonaws.com/dev/send-email">
				<span class="contact100-form-title">
					Send Us A Message
				</span>

				<div class="wrap-input100 validate-input" data-validate="Please enter your name">
					<input class="input100" type="text" name="name" placeholder="Full Name">
					<span class="focus-input100"></span>
				</div>

				<div class="wrap-input100 validate-input" data-validate="Please enter your email: e@a.x">
					<input class="input100" type="text" name="email" placeholder="E-mail">
					<span class="focus-input100"></span>
				</div>

				<div class="wrap-input100 validate-input" data-validate="Please enter your phone">
					<input class="input100" type="text" name="phone" placeholder="Phone">
					<span class="focus-input100"></span>
				</div>

				<div class="wrap-input100 validate-input" data-validate="Please enter your message">
					<textarea class="input100" name="message" placeholder="Your Message"></textarea>
					<span class="focus-input100"></span>
				</div>

				<div class="container-contact100-form-btn">
					<button class="contact100-form-btn" type="submit">
						<span>
							<i class="fa fa-paper-plane-o m-r-6" aria-hidden="true"></i>
							Send
						</span>
					</button>
				</div>
			</form>
		</div>
	</div>

	<div id="dropDownSelect1"></div>

	<!--===============================================================================================-->
	<script src="https://static.zimbasolutions.io/vendor/jquery/jquery-3.2.1.min.js"></script>
	<!--===============================================================================================-->
	<script src="https://static.zimbasolutions.io/vendor/animsition/js/animsition.min.js"></script>
	<!--===============================================================================================-->
	<script src="https://static.zimbasolutions.io/vendor/bootstrap/js/popper.js"></script>
	<script src="https://static.zimbasolutions.io/vendor/bootstrap/js/bootstrap.min.js"></script>
	<!--===============================================================================================-->
	<script src="https://static.zimbasolutions.io/vendor/select2/select2.min.js"></script>
	<!--===============================================================================================-->
	<script src="https://static.zimbasolutions.io/vendor/daterangepicker/moment.min.js"></script>
	<script src="https://static.zimbasolutions.io/vendor/daterangepicker/daterangepicker.js"></script>
	<!--===============================================================================================-->
	<script src="https://static.zimbasolutions.io/vendor/countdowntime/countdowntime.js"></script>
	<!--===============================================================================================-->
	<script src="https://static.zimbasolutions.io/js/main.js"></script>
	<!--===============================================================================================-->
	<script>
		// client-side js
		// run by the browser each time your view template is loaded

		console.log("running form to JSON function");

		const formElem = document.getElementById('send-us-a-message-form');

		// submit handler

		formElem.addEventListener('submit', (e) => {
			// on form submission, prevent default
			e.preventDefault();

			// construct a FormData object, which fires the formdata event
			new FormData(formElem);
		});

		// formdata handler to retrieve data
		formElem.onformdata = (e) => {
			console.log('formdata fired');

			const formFields = {}
			e.formData.forEach((value, key) => formFields[key] = value);
			let data = JSON.stringify(formFields)

			const userMessage =   ` Thank you ${formFields['name'].split(' ')[0]}, we shall email you back at email address ${formFields['email']}`;

			console.log(data);
			console.log(userMessage)

			// submit the data via XHR
			const request = new XMLHttpRequest();
			request.onreadystatechange = function () {
				if (this.readyState == 4 && this.status == 200 || this.status == 302) {
					const formElement = document.getElementById("send-us-a-message-form");
					const template = document.getElementById("thank-you");
					// document.getElementById("send-us-a-message-form").remove();

					const clone = template.content.cloneNode(true);
					const h1 = clone.querySelectorAll('h2')
					h1[0].textContent = userMessage;
					formElement.parentNode.replaceChild(clone, formElement);
					// document.body.appendChild(clone);
				}
			};
			request.open("POST", formElem.action);
			request.send(data);

		};
	</script>
	<template id="thank-you">
		<h2></h2>
	</template>

</body>

</html>